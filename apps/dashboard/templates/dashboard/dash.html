{% extends "landing/base.html" %}

{% block content %}

<div>
    <h1 class='display-4 center'><em>Dozo</em></h3>
        <p class=center>
        Welcome, <strong>{{request.user.first_name}}</strong>! Let's crush those assignments!<br>
        <small>
            You logged in on <strong>{{request.user.last_login}}</strong><br>
            <strong>Users online:</strong> 
    {% for user in online_users %}
        {% if online_users|length == 1 %}
            {{user.username}} (just you!)
        {% else %}
            {{user.username}} ({{user.first_name}}) &nbsp;
        {% endif %}
    {% endfor %}
        </small>
        </p>
</div>

<div class=kanban>

<div class="border border-top-0 border-bottom-0 lane">
<h5 class=center>Your Assignments</h5><hr>

{% if not assignments|length %}

    <p><strong>Select a Track</strong></p>
    <small>
    <p>Select a track from the menu to work through your assignments.</p>
    </small>

    <form method=POST action="{% url 'dashboard:assignments' %}">
        <div class=form_group>{% csrf_token %}
            <select name=track class=form-control>
                <option value=py_fun>Python Fundamentals</option>
                <option value=py_django_orm>Python: Django</option>
            </select>
        </div>
        <p><button type=submit class='btn btn-primary'>Ready!</button></p>    
    </form>
        
{% elif assignments|length %}

    <div class="list-group">
    {% for assignment in assignments %}
        <a href="{% url 'dashboard:addtoplans' assignment.id %}" class="color{{assignment.points}} list-group-item list-group-item-action align-items-start">
            <div class="d-flex w-100 justify-content-between">
            <small class="mb-1"><strong>{{assignment.title}}</strong> {% if assignment.optional %}<br>(Optional){% endif %}</small>
            <small>{{assignment.points}}pts</small>
            </div>
            <small class="mb-1">
                Est. Time: {{assignment.est_duration}}<br>
                Time Multiplier: {{assignment.time_mult|floatformat}}
            </small>
        </a>
    {% endfor %}
    </div>

{% endif %}
</div>

<div class="border border-top-0 border-bottom-0 border-left-0 lane">
<h5 class=center>This Session</h5><hr>
{% if not commit|length %}
    <p><strong>Plan Your Session</strong></p>
    <small>
    <p>How many assignments can you finish? You'll earn points for each assignment. Plus, you can multiply those points by:</p>
    <p>1) Completing assignments on time<br>
        2) Completing all your assignments in one session</p>
    </small>
{% endif %}
{% if plans|length %}
    <div class="list-group">
    {% for assignment in plans %}
    <a href="{% url 'dashboard:remfromplans' assignment.id %}" class="color{{assignment.points}} list-group-item list-group-item-action align-items-start">
        <div class="d-flex w-100 justify-content-between">
          <small class="mb-1"><strong>{{assignment.title}}</strong> {% if assignment.optional %}<br>(Optional){% endif %}</small>
          <small>{{assignment.points}}pts</small>
        </div>
        <small class="mb-1">
            Est. Time: {{assignment.est_duration}}<br>
            Time Multiplier: {{assignment.time_mult|floatformat }}
        </small>
    </a>
    {% endfor %}
    </div>
{% elif commit|length %}
    <p><strong>Session List:</strong></p>
    <div class="list-group">
    {% for assignment in commit %}
    <a href =# class="color{{assignment.points}} list-group-item list-group-item-action align-items-start">
        <div class="d-flex w-100 justify-content-between">
          <small class="mb-1"><strong>{{assignment.title}}</strong> {% if assignment.optional %}<br>(Optional){% endif %}</small>
          <small>{{assignment.points}}pts</small>
        </div>
        <small class="mb-1">
            Est. Time: {{assignment.est_duration}}<br>
            Time Multiplier: {{assignment.time_mult|floatformat }}
        </small>
    </a>
    {% endfor %}
    </div>
{% endif %}<br>

</div>

<div class="border border-top-0 border-bottom-0 border-left-0 lane">
<h5 class=center>Currently Working On</h5><hr>
{% if commit|length %}
    <p><strong>Keep On Working</strong></p>
    <small>
        <p>Good job! Now it's time to work. When you click the button, the timer for your first assignment will start.</p>
    </small>
    <p><a href="{% url 'dashboard:go' %}"><button type=submit class='btn btn-primary'>Go!</button></a></p><br>
{% endif %}
{% if plans|length or not commit|length %}
    <p><strong>Keep On Working</strong></p>
    <small>
        <p>Edit your plans by clicking the assignments again. When you're ready, click the button to commit to working throughout this session.</p>
    </small>
{% endif %}
{% if not commit|length %}
    <p><a href="{% url 'dashboard:commit' %}"><button type=submit class='btn btn-primary'>Set!</button></a></p>
{% endif %}

</div>
<div class="border border-top-0 border-bottom-0 border-left-0 lane">
<h5 class=center>Done!</h5><hr>

<p><strong>Move Assignments Here</strong></p>
<small>
    <p>This is your goal. Move as many assignments as you can to this lane!</p>
</small>
    <div class="list-group">
    <a class="list-group-item align-items-start">
            <div class="d-flex w-100 justify-content-between">
            <small class="mb-1"><strong>Potential Points</strong></small>
            </div>
            <small class="mb-1">
                {% if plans|length %}
                Number of Assignments: <big><strong>{{plans|length}}</strong></big><br>
                {% else %}
                Number of Assignments: <big><strong>{{commit|length}}</strong></big><br>
                {% endif %}
                Potential Points: <big><strong>{{potential_points}}</strong></big>
            </small>
        </a>
    </div>

</div>
</div>

{% endblock %}